{% load static %}
<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}My Page{% endblock %}</title>
   
  
  <!-- FontAwesome Solid icons CDN -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-pVfGf1Qz2g6MHV6qHTj4a6ie7RRiZL19P049f0wob6EevUfxnmHnckzfDfXZBcv1tp0Tp0ZlfXvCJVa/i9XYZg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  
  <style>
    html, body {
      height: 100%; margin: 0; overflow-x: hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial;
      background: #000;
    }

    /* Background Layers */
    .bg_day_night_sky {
      position: fixed; inset: 0; z-index: 0;
      transition: background 1s linear;
    }
    .bg_day_night_haze {
      position: fixed; inset: 0; pointer-events: none; z-index: 1;
      mix-blend-mode: screen; opacity: .5; filter: blur(18px);
      background:
        radial-gradient(60vh 40vh at 50% 110%, rgba(255,200,120,.18), transparent 60%),
        radial-gradient(70vh 50vh at 50% 110%, rgba(110,170,255,.10), transparent 70%);
      transition: opacity 1s linear;
    }
    canvas.bg_day_night_stars, canvas.bg_day_night_orb {
      position: fixed; inset: 0; width: 100vw; height: 100vh; display: block;
    }
    canvas.bg_day_night_stars { z-index: 2; }
    canvas.bg_day_night_orb   { z-index: 3; }

    /* Desktop Navbar */
    nav.bg_day_night_navbar {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 60px;
      z-index: 20; display: flex; align-items: center;
      justify-content: flex-start; padding: 0 10px;
      backdrop-filter: blur(4px);
      border-bottom: 1px solid rgba(255,255,255,0.2);
      transition:
        background-color 0.5s linear,
        border-color 0.5s linear,
        color 0.5s linear,
        box-shadow 0.3s ease;
      font-weight: 500;
      background-color: rgba(0,0,0,0.25);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow-x: auto;
      scrollbar-width: none;
    }
    nav.bg_day_night_navbar::-webkit-scrollbar { display: none; }

    nav.bg_day_night_navbar .logo {
      font-size: 1.3rem; font-weight: 700; color: white;
      margin-right: 20px;
      user-select:none;
      white-space: nowrap;
    }

    .nav-fields-wrapper {
      position: relative;
      display: flex;
      gap: 30px;
      align-items: center;
    }

    nav.bg_day_night_navbar .nav-links {
      display: flex; gap: 30px;
      position: relative;
      user-select:none;
      white-space: nowrap;
    }

    /* Nav links desktop style */
    nav.bg_day_night_navbar .nav-links a {
      text-decoration: none;
      color: white;
      font-size: 1rem; 
      position: relative;
      padding: 8px 12px;
      cursor: pointer;
      transition: color 0.3s ease, text-shadow 0.3s ease;
      display: flex;
      align-items: center;
      font-weight: 500;
      gap: 8px;
    }
    nav.bg_day_night_navbar .nav-links a i {
      font-size: 20px;
      color: #aaa; /* default outline color */
      font-weight: 400; /* regular */
      transition: color 0.3s ease, transform 0.2s ease;
    }
    nav.bg_day_night_navbar .nav-links a:hover i {
      color: #ffc75f; /* hover color */
      transform: scale(1.15);
    }
    nav.bg_day_night_navbar .nav-links a.active i {
      font-weight: 900; /* solid */
      color: #ffc75f;  /* active color */
      transform: scale(1.2);
    }
    nav.bg_day_night_navbar .nav-links a:hover,
    nav.bg_day_night_navbar .nav-links a.active {
      color: #ffd27f;
      text-shadow: 0 0 4px #ffd27f88;
    }

    .nav-highlight {
      position: absolute;
      bottom: 0;
      height: 3px;
      background: #ffd27f;
      border-radius: 3px 3px 0 0;
      transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1), width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: left, width;
      z-index: 5;
    }

    /* Mobile bottom nav */
    .nav-icons {
      display: none;
      gap: 14px;
      align-items: center;
      justify-content: space-around;
      width: 100%;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 210, 127, 0.3);
      padding: 10px 0 14px 0;
      position: fixed;
      bottom: 0; left: 0;
      z-index: 25;
      user-select: none;
    }

    .nav-icons button {
      background: none;
      border: none;
      color: white;
      font-size: 28px;
      cursor: pointer;
      transition: color 0.3s ease, box-shadow 0.35s ease, background-color 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-weight: 600;
      padding: 4px 0 6px 0;
      border-radius: 16px;
      width: 52px;
      height: 56px;
      position: relative;
      outline-offset: 2px;
    }
    .nav-icons button span {
      font-size: 10px;
      margin-top: 2px;
      line-height: 1;
      user-select:none;
      pointer-events:none;
    }
    /* On mobile, hide text label for a cleaner icon-only look */
    @media (max-width: 768px) {
      .nav-icons button span {
        display: none;
      }
    }

    .nav-icons button:hover,
    .nav-icons button:focus-visible {
      color: #ffd27f;
      box-shadow: 0 0 18px #ffd27fcc;
    }
    .nav-icons button.active {
      color: #ffc75f;
      background-color: rgba(255, 200, 90, 0.25);
      box-shadow: 0 0 32px #ffc75fff;
      transform: scale(1.1);
      transition: box-shadow 0.35s ease, transform 0.2s ease;
    }

    /* Main content */
    main.bg_day_night_content {
      position: relative; z-index: 10; min-height: 100vh;
      padding: 80px 20px 90px 20px; /* bottom padding for nav */
      display: grid;
      place-items: center;
      text-align: center;
      color: white;
      text-shadow: 0 2px 12px rgba(0,0,0,.6);
    }

    .bg_day_night_badge {
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.2);
      border-radius: 16px;
      padding: 14px 20px;
      backdrop-filter: blur(6px);
      transition: 1s linear, border-color 1s linear;
      user-select:none;
    }

    /* Responsive hide desktop navbar and show mobile nav */
    @media (max-width: 768px) {
      nav.bg_day_night_navbar {
        display: none;
      }
      .nav-icons {
        display: flex;
      }
    }

    /* Smooth fade/scale animation for optional new anim */
    @keyframes fadeInScale {
      0% { opacity: 0; transform: scale(0.95); }
      100% { opacity: 1; transform: scale(1); }
    }
    .fade-in-scale {
      animation: fadeInScale 0.4s ease forwards;
    }
  </style>

</head>
<body>
  <!-- Background layers -->
  <div id="bg_day_night_sky" class="bg_day_night_sky"></div>
  <div id="bg_day_night_haze" class="bg_day_night_haze"></div>
  <canvas id="bg_day_night_stars" class="bg_day_night_stars"></canvas>
  <canvas id="bg_day_night_orb" class="bg_day_night_orb"></canvas>

  <!-- Desktop Navbar -->
  <nav class="bg_day_night_navbar" id="bg_day_night_navbar" role="navigation" aria-label="Primary Navigation">
    <div class="logo" aria-label="Site Logo">My Portfolio</div>
    <div class="nav-fields-wrapper">
      <div class="nav-links" role="menubar" aria-label="Primary menu">
        <a href="#" role="menuitem" data-target="Home" class="active" tabindex="0" aria-current="page"><i class="fa-solid fa-house"></i>Home</a>
        <a href="#" role="menuitem" data-target="Projects" tabindex="0"><i class="fa-solid fa-folder-open"></i>Projects</a>
        <a href="#" role="menuitem" data-target="Feed" tabindex="0"><i class="fa-solid fa-rss"></i>Feed</a>
        <a href="#" role="menuitem" data-target="Certificates" tabindex="0"><i class="fa-solid fa-certificate"></i>Certificates</a>
        <a href="#" role="menuitem" data-target="Skills" tabindex="0"><i class="fa-solid fa-chart-simple"></i>Skills</a>
        <a href="#" role="menuitem" data-target="Contact" tabindex="0"><i class="fa-solid fa-envelope"></i>Contact</a>
        <a href="#" role="menuitem" data-target="Resume" tabindex="0"><i class="fa-solid fa-file-lines"></i>Resume</a>
      </div>
      <div class="nav-highlight" aria-hidden="true"></div>
    </div>
  </nav>

  <!-- Mobile bottom Navigation -->
  <nav class="nav-icons" aria-label="Mobile Navigation">
    <button type="button" aria-label="Home" data-target="Home" class="active" aria-pressed="true">
      <i class="fa-solid fa-house"></i><span>Home</span>
    </button>
    <button type="button" aria-label="Projects" data-target="Projects" aria-pressed="false">
      <i class="fa-solid fa-folder-open"></i><span>Projects</span>
    </button>
    <button type="button" aria-label="Feed" data-target="Feed" aria-pressed="false">
      <i class="fa-solid fa-rss"></i><span>Feed</span>
    </button>
    <button type="button" aria-label="Certificates" data-target="Certificates" aria-pressed="false">
      <i class="fa-solid fa-certificate"></i><span>Certificates</span>
    </button>
    <button type="button" aria-label="Skills" data-target="Skills" aria-pressed="false">
      <i class="fa-solid fa-chart-simple"></i><span>Skills</span>
    </button>
    <button type="button" aria-label="Contact" data-target="Contact" aria-pressed="false">
      <i class="fa-solid fa-envelope"></i><span>Contact</span>
    </button>
    <button type="button" aria-label="Resume" data-target="Resume" aria-pressed="false">
      <i class="fa-solid fa-file-lines"></i><span>Resume</span>
    </button>
  </nav>

  <!-- Main Content -->
  <main class="bg_day_night_content" id="main-content" tabindex="-1">
    <div class="bg_day_night_badge" id="bg_day_night_label">Loading sky…</div>
    {% block content %}{% endblock %}
  </main>

  <script>
    (() => {
      const DAY_START = 6, DAY_END = 18, TWILIGHT = 1.0, LUNAR_PERIOD = 29.530588;
      const skyEl = document.getElementById('bg_day_night_sky');
      const hazeEl = document.getElementById('bg_day_night_haze');
      const label = document.getElementById('bg_day_night_label');
      const navbar = document.getElementById('bg_day_night_navbar');
      const starsCanvas = document.getElementById('bg_day_night_stars');
      const orbCanvas = document.getElementById('bg_day_night_orb');
      const sctx = starsCanvas.getContext('2d');
      const octx = orbCanvas.getContext('2d');

      let W, H, DPR = 1, stars = [], rafStars, rafOrbs;

      const clamp = (x, a, b) => Math.max(a, Math.min(b, x));
      const lerp = (a, b, t) => a + (b - a) * t;
      const rand = (min, max) => Math.random()*(max-min)+min;

      function setCanvasSize() {
        DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        W = starsCanvas.clientWidth; H = starsCanvas.clientHeight;
        [starsCanvas, orbCanvas].forEach(c => {
          c.width = Math.floor(W*DPR);
          c.height = Math.floor(H*DPR);
          const ctx = (c===starsCanvas?sctx:octx);
          ctx.setTransform(DPR,0,0,DPR,0,0);
        });
      }

      function nowInfo() {
        const d = new Date();
        const hours = d.getHours()+d.getMinutes()/60;
        const dayT = clamp((hours-DAY_START)/(DAY_END-DAY_START),0,1);
        let nightHours = hours; if(nightHours<DAY_START) nightHours+=24;
        const nightT = clamp((nightHours-DAY_END)/(24+DAY_START-DAY_END),0,1);
        const epoch = new Date(Date.UTC(2000,0,6,18,14,0));
        const phaseFrac = (((d-epoch)/86400000)%LUNAR_PERIOD)/LUNAR_PERIOD;
        return {d,hours,dayT,nightT,phaseFrac};
      }

      function twilightFactor(h) {
        let t = 0;
        if(h >= DAY_START-TWILIGHT && h < DAY_START+TWILIGHT) t = 1-Math.abs(h-DAY_START)/TWILIGHT;
        else if(h >= DAY_END-TWILIGHT && h < DAY_END+TWILIGHT) t = 1-Math.abs(h-DAY_END)/TWILIGHT;
        return clamp(t,0,1);
      }

      function setSkyByTime(info) {
        const h = info.hours, twi = twilightFactor(h);
        let bg, navbarBg, navbarBorder, textColor;

        if(twi>0) {
          bg = `linear-gradient(180deg,rgb(255,120,80),rgb(25,20,50))`;
          hazeEl.style.opacity = 0.4;
          navbarBg = 'rgba(50,30,80,0.8)';
          navbarBorder = 'rgba(200,180,220,0.3)';
          textColor = 'rgba(255,255,255,0.95)';
          navbar.style.boxShadow = '0 4px 12px rgba(255, 160, 40, 0.3)';
        }
        else if(h >= DAY_START && h <= DAY_END) {
          const tMidday = Math.abs((h-12)/6);
          const deep = `rgb(${lerp(40,20,tMidday)},${lerp(110,80,tMidday)},${lerp(205,170,tMidday)})`;
          const light = `rgb(${lerp(140,170,tMidday)},${lerp(190,200,tMidday)},${lerp(255,230,tMidday)})`;
          bg = `linear-gradient(180deg,${deep},${light})`;
          hazeEl.style.opacity = 0.35;
          navbarBg = 'rgba(255,255,255,0.15)';
          navbarBorder = 'rgba(255,255,255,0.25)';
          textColor = 'rgba(20,20,30,1)';
          navbar.style.boxShadow = '0 2px 8px rgba(255, 255, 255, 0.15)';
        }
        else {
          bg = `linear-gradient(180deg,rgb(10,20,60),rgb(8,12,28))`;
          hazeEl.style.opacity = 0.2;
          navbarBg = 'rgba(20,30,60,0.85)';
          navbarBorder = 'rgba(150,180,220,0.25)';
          textColor = 'rgba(255,255,255,0.9)';
          navbar.style.boxShadow = '0 4px 14px rgba(40, 50, 100, 0.4)';
        }

        skyEl.style.background = bg;
        navbar.style.backgroundColor = navbarBg;
        navbar.style.borderBottomColor = navbarBorder;
        navbar.querySelector('.logo').style.color = textColor;
        navbar.querySelectorAll('.nav-links a').forEach(a => {
          if(a.classList.contains('active')) {
            a.style.color = '#ffd27f';
            a.style.textShadow = '0 0 4px #ffd27f88';
          } else {
            a.style.color = textColor;
            a.style.textShadow = 'none';
          }
        });
      }

      function initStars() {
        const area = W*H/10000;
        const count = Math.max(120, Math.floor(area*40));
        stars = new Array(count).fill(0).map(() => ({
          x: rand(0,W), y: rand(0,H), r: rand(0.4, 1.6), alpha: rand(0.2,0.8)
        }));
      }

      function starDensityForHour(h) {
        const twi = twilightFactor(h);
        if(h >= DAY_START && h <= DAY_END) return twi * 0.6;
        return 1;
      }

      function drawStars() {
        const h = new Date().getHours()+ new Date().getMinutes()/60;
        const density = starDensityForHour(h);
        sctx.clearRect(0, 0, W, H);
        if(density === 0) return;
        stars.forEach(s => {
          sctx.fillStyle = `rgba(255,255,255,${s.alpha*density})`;
          sctx.beginPath();
          sctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
          sctx.fill();
        });
        rafStars = requestAnimationFrame(drawStars);
      }

      function sunPos(dayT) { return { x: lerp(0.1, 0.9, dayT), y: 0.9 - Math.sin(dayT*Math.PI)*0.7 } }
      function moonPos(nightT) { return { x: lerp(0.1, 0.9, nightT), y: 0.9 - Math.sin(nightT*Math.PI)*0.65 } }

      function drawSun(octx, cx, cy, size, alpha=1) {
        octx.globalAlpha = alpha;
        const r = size;
        const grad = octx.createRadialGradient(cx, cy, 0, cx, cy, r*3);
        grad.addColorStop(0, 'rgba(255,230,150,0.95)');
        grad.addColorStop(1, 'rgba(255,160,40,0)');
        octx.fillStyle = grad;
        octx.beginPath();
        octx.arc(cx, cy, r*3, 0, Math.PI*2);
        octx.fill();
        octx.fillStyle = 'rgb(255,240,180)';
        octx.beginPath();
        octx.arc(cx, cy, r, 0, Math.PI*2);
        octx.fill();
        octx.globalAlpha = 1;
      }

      function drawMoon(octx, cx, cy, size, phaseFrac, sunX, sunY, alpha=1) {
        octx.globalAlpha = alpha;
        const r = size;
        const halo = octx.createRadialGradient(cx, cy, 0, cx, cy, r*3);
        halo.addColorStop(0, 'rgba(200,210,255,0.35)');
        halo.addColorStop(1, 'rgba(200,210,255,0)');
        octx.fillStyle = halo;
        octx.beginPath();
        octx.arc(cx, cy, r*3, 0, Math.PI*2);
        octx.fill();
        octx.fillStyle = 'rgb(100,100,120)';
        octx.beginPath();
        octx.arc(cx, cy, r, 0, Math.PI*2);
        octx.fill();
        const angle = Math.atan2(sunY - cy, sunX - cx);
        const phase = Math.cos(phaseFrac*2*Math.PI);
        octx.save();
        octx.translate(cx, cy);
        octx.rotate(angle);
        const lit = clamp((phase+1)/2, 0, 1);
        const litW = r*lit*2;
        octx.beginPath();
        octx.ellipse(0, 0, litW/2, r, 0, 0, Math.PI*2);
        octx.fillStyle = 'rgb(230,235,255)';
        octx.fill();
        octx.restore();
        octx.globalAlpha = 1;
      }

      function drawOrbs() {
        const info = nowInfo();
        setSkyByTime(info);
        octx.clearRect(0, 0, W, H);
        const h = info.hours, twi = twilightFactor(h), isDay = (h >= DAY_START && h <= DAY_END);
        let sunX, sunY;
        if(isDay || twi > 0){
          const pos = sunPos(info.dayT);
          sunX = pos.x*W; sunY = pos.y*H;
          drawSun(octx,sunX,sunY,24,isDay?1:twi);
        } else sunX = sunY = -9999;
        if(!isDay || twi>0){
          const pos = moonPos(info.nightT);
          drawMoon(octx,pos.x*W,pos.y*H,22,info.phaseFrac,sunX,sunY,!isDay?twi:1);
        }
        const ampm = h>=12?'PM':'AM';
        const hh = Math.floor(h)%12||12;
        const mm = String(new Date().getMinutes()).padStart(2,'0');
        label.textContent = `${hh}:${mm} ${ampm} • ${twi>0?'Twilight':(isDay?'Day':'Night')} • Moon phase ${(info.phaseFrac*29.53).toFixed(1)}/29.5d`;
        rafOrbs = requestAnimationFrame(drawOrbs);
      }

      function init() {
        setCanvasSize();
        initStars();
        cancelAnimationFrame(rafStars);
        cancelAnimationFrame(rafOrbs);
        drawStars();
        drawOrbs();
        initNavHighlight();
        initMobileNav();
      }

      window.addEventListener('resize', () => {
        setCanvasSize();
        initStars();
        placeNavHighlight();
      }, {passive:true});

      document.addEventListener('visibilitychange', () => {
        if(document.hidden){
          cancelAnimationFrame(rafStars);
          cancelAnimationFrame(rafOrbs);
        } else {
          drawStars();
          drawOrbs();
        }
      });

      // Desktop nav highlight logic
      const navLinks = navbar.querySelectorAll('.nav-links a');
      const navHighlight = navbar.querySelector('.nav-highlight');
      let currentActive = navbar.querySelector('.nav-links a.active') || navLinks[0];

      function placeNavHighlight(){
        if(!currentActive) return;
        const containerRect = navbar.querySelector('.nav-links').getBoundingClientRect();
        const activeRect = currentActive.getBoundingClientRect();
        const left = activeRect.left - containerRect.left + navbar.querySelector('.nav-links').scrollLeft;
        const width = activeRect.width;
        navHighlight.style.left = left + 'px';
        navHighlight.style.width = width + 'px';
      }

      function clearActiveLinks(){
        navLinks.forEach(a => a.classList.remove('active'));
      }

      function initNavHighlight(){
        placeNavHighlight();
        navLinks.forEach(link => {
          link.addEventListener('click', e => {
            e.preventDefault();
            if(link === currentActive) return;
            clearActiveLinks();
            link.classList.add('active');
            currentActive = link;
            placeNavHighlight();
            updateMobileActive(link.dataset.target);
          });
          link.addEventListener('keydown', e => {
            if(e.key === 'Enter' || e.key === ' '){
              e.preventDefault();
              link.click();
            }
          });
        });
        window.addEventListener('resize', () => { placeNavHighlight(); });
      }

      const mobileNav = document.querySelector('.nav-icons');
      const mobileButtons = Array.from(mobileNav.querySelectorAll('button'));

      function clearMobileActive(){
        mobileButtons.forEach(btn => {
          btn.classList.remove('active');
          btn.setAttribute('aria-pressed', 'false');
        });
      }

      function updateMobileActive(target){
        clearMobileActive();
        const btn = mobileButtons.find(b => b.dataset.target === target);
        if(btn){
          btn.classList.add('active');
          btn.setAttribute('aria-pressed', 'true');
        }
      }

      function initMobileNav(){
        mobileButtons.forEach(btn => {
          btn.addEventListener('click', e => {
            e.preventDefault();
            const target = btn.dataset.target;
            const desktopLink = Array.from(navLinks).find(a => a.dataset.target === target);
            if(desktopLink){
              desktopLink.click();
              desktopLink.scrollIntoView({behavior:'smooth', inline:'center'});
            }
            updateMobileActive(target);
          });
          btn.addEventListener('keydown', e => {
            if(e.key === 'Enter' || e.key === ' '){
              e.preventDefault();
              btn.click();
            }
          });
        });
        if(currentActive) updateMobileActive(currentActive.dataset.target);
      }
      init();
  })();
  </script>
</body>
</html>